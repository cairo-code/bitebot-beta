{"level":"error","message":"Callback query error: this.startAddMenuItem is not a function","stack":"TypeError: this.startAddMenuItem is not a function\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/bot.js:73:22)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:181:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:792:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues [as _onImmediate] (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)","timestamp":"2025-03-05T11:44:25.193Z"}
{"level":"error","message":"Callback query error: this.startAddMenuItem is not a function","stack":"TypeError: this.startAddMenuItem is not a function\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/bot.js:73:22)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:181:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:792:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues [as _onImmediate] (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)","timestamp":"2025-03-05T11:45:07.055Z"}
{"level":"error","message":"Bot startup error: this.initializeDatabase is not a function","stack":"TypeError: this.initializeDatabase is not a function\n    at RestaurantOrderBot.start (/home/freddy/BiteBot/bot.js:117:18)\n    at Object.<anonymous> (/home/freddy/BiteBot/bot.js:127:5)\n    at Module._compile (node:internal/modules/cjs/loader:1565:14)\n    at Object..js (node:internal/modules/cjs/loader:1708:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)\n    at Function._load (node:internal/modules/cjs/loader:1128:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:322:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:219:24)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:170:5)\n    at node:internal/main/run_main_module:36:49","timestamp":"2025-03-05T11:53:40.019Z"}
{"level":"error","message":"Bot startup error: this.initializeDatabase is not a function","stack":"TypeError: this.initializeDatabase is not a function\n    at RestaurantOrderBot.start (/home/freddy/BiteBot/bot.js:117:18)\n    at Object.<anonymous> (/home/freddy/BiteBot/bot.js:127:5)\n    at Module._compile (node:internal/modules/cjs/loader:1565:14)\n    at Object..js (node:internal/modules/cjs/loader:1708:10)\n    at Module.load (node:internal/modules/cjs/loader:1318:32)\n    at Function._load (node:internal/modules/cjs/loader:1128:12)\n    at TracingChannel.traceSync (node:diagnostics_channel:322:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:219:24)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:170:5)\n    at node:internal/main/run_main_module:36:49","timestamp":"2025-03-05T11:53:49.874Z"}
{"level":"error","message":"Callback query error: this.startAddMenuItem is not a function","stack":"TypeError: this.startAddMenuItem is not a function\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/script.js:73:22)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:181:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:792:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues [as _onImmediate] (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)","timestamp":"2025-03-05T12:03:28.065Z"}
{"level":"error","message":"Callback query error: this.startAddMenuItem is not a function","stack":"TypeError: this.startAddMenuItem is not a function\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/script.js:73:22)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:181:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:792:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues [as _onImmediate] (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)","timestamp":"2025-03-05T12:03:29.939Z"}
{"level":"error","message":"Callback query error: this.startAddMenuItem is not a function","stack":"TypeError: this.startAddMenuItem is not a function\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/script.js:73:22)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:181:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:792:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues [as _onImmediate] (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)","timestamp":"2025-03-05T12:03:30.305Z"}
{"code":"ER_CANT_CREATE_TABLE","errno":1005,"level":"error","message":"Error initializing database: Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")","sql":"\n        CREATE TABLE IF NOT EXISTS users (\n          id INT AUTO_INCREMENT PRIMARY KEY,\n          user_id BIGINT UNIQUE NOT NULL,\n          role ENUM('admin', 'worker') NOT NULL,\n          name VARCHAR(255) NOT NULL,\n          phone_number VARCHAR(20) NOT NULL,\n          uuid VARCHAR(36) NOT NULL,\n          restaurant_id INT,\n          FOREIGN KEY (restaurant_id) REFERENCES restaurants(id)\n        )\n      ","sqlMessage":"Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")","sqlState":"HY000","stack":"Error: Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")\n    at PromisePoolConnection.query (/home/freddy/BiteBot/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at RestaurantOrderBot.initDatabase (/home/freddy/BiteBot/script.js:35:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RestaurantOrderBot.start (/home/freddy/BiteBot/script.js:108:5)"}
{"code":"ER_NO_SUCH_TABLE","errno":1146,"level":"error","message":"Error fetching user: Table 'BiteBot.users' doesn't exist","sql":"SELECT * FROM users WHERE user_id = 5309273112","sqlMessage":"Table 'BiteBot.users' doesn't exist","sqlState":"42S02","stack":"Error: Table 'BiteBot.users' doesn't exist\n    at PromisePool.query (/home/freddy/BiteBot/node_modules/mysql2/lib/promise/pool.js:36:22)\n    at RestaurantOrderBot.getUserByTelegramId (/home/freddy/BiteBot/script.js:641:38)\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/script.js:116:31)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:182:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:706:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)"}
{"code":"ER_KEY_COLUMN_DOES_NOT_EXITS","errno":1072,"level":"error","message":"Error initializing database: Key column 'restaurant_id' doesn't exist in table","sql":"\n        CREATE TABLE IF NOT EXISTS users (\n          id INT AUTO_INCREMENT PRIMARY KEY,\n          user_id BIGINT UNIQUE NOT NULL,\n          role ENUM('admin', 'worker') NOT NULL,\n          name VARCHAR(255) NOT NULL,\n          phone_number VARCHAR(20) NOT NULL,\n          uuid VARCHAR(36) NOT NULL,\n          FOREIGN KEY (restaurant_id) REFERENCES restaurants(id)\n        )\n      ","sqlMessage":"Key column 'restaurant_id' doesn't exist in table","sqlState":"42000","stack":"Error: Key column 'restaurant_id' doesn't exist in table\n    at PromisePoolConnection.query (/home/freddy/BiteBot/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at RestaurantOrderBot.initDatabase (/home/freddy/BiteBot/script.js:35:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RestaurantOrderBot.start (/home/freddy/BiteBot/script.js:107:5)"}
{"code":"ER_CANT_CREATE_TABLE","errno":1005,"level":"error","message":"Error initializing database: Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")","sql":"\n        CREATE TABLE IF NOT EXISTS users (\n          id INT AUTO_INCREMENT PRIMARY KEY,\n          user_id BIGINT UNIQUE NOT NULL,\n          role ENUM('admin', 'worker') NOT NULL,\n          name VARCHAR(255) NOT NULL,\n          phone_number VARCHAR(20) NOT NULL,\n          uuid VARCHAR(36) NOT NULL,\n          restaurant_id INT,\n          FOREIGN KEY (restaurant_id) REFERENCES restaurants(id)\n        )\n      ","sqlMessage":"Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")","sqlState":"HY000","stack":"Error: Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")\n    at PromisePoolConnection.query (/home/freddy/BiteBot/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at RestaurantOrderBot.initDatabase (/home/freddy/BiteBot/script.js:35:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RestaurantOrderBot.start (/home/freddy/BiteBot/script.js:108:5)"}
{"code":"ER_CANT_CREATE_TABLE","errno":1005,"level":"error","message":"Error initializing database: Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")","sql":"\n        CREATE TABLE IF NOT EXISTS users (\n          id INT AUTO_INCREMENT PRIMARY KEY,\n          user_id BIGINT UNIQUE NOT NULL,\n          role ENUM('admin', 'worker') NOT NULL,\n          name VARCHAR(255) NOT NULL,\n          phone_number VARCHAR(20) NOT NULL,\n          uuid VARCHAR(36) NOT NULL,\n          restaurant_id INT,\n          FOREIGN KEY (restaurant_id) REFERENCES restaurants(id)\n        )\n      ","sqlMessage":"Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")","sqlState":"HY000","stack":"Error: Can't create table `BiteBot`.`users` (errno: 150 \"Foreign key constraint is incorrectly formed\")\n    at PromisePoolConnection.query (/home/freddy/BiteBot/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at RestaurantOrderBot.initDatabase (/home/freddy/BiteBot/script.js:35:24)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RestaurantOrderBot.start (/home/freddy/BiteBot/script.js:108:5)"}
{"level":"error","message":"Callback query error: this.startAddMenuItem is not a function","stack":"TypeError: this.startAddMenuItem is not a function\n    at TelegramBot.<anonymous> (/home/freddy/BiteBot/bot.old.js:73:22)\n    at TelegramBot.emit (/home/freddy/BiteBot/node_modules/eventemitter3/index.js:181:35)\n    at TelegramBot.processUpdate (/home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegram.js:792:12)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:110:22\n    at Array.forEach (<anonymous>)\n    at /home/freddy/BiteBot/node_modules/node-telegram-bot-api/src/telegramPolling.js:106:17\n    at tryCatcher (/home/freddy/BiteBot/node_modules/bluebird/js/release/util.js:16:23)\n    at Promise._settlePromiseFromHandler (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:547:31)\n    at Promise._settlePromise (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:604:18)\n    at Promise._settlePromise0 (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:649:10)\n    at Promise._settlePromises (/home/freddy/BiteBot/node_modules/bluebird/js/release/promise.js:729:18)\n    at _drainQueueStep (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:93:12)\n    at _drainQueue (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:86:9)\n    at Async._drainQueues (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:102:5)\n    at Async.drainQueues [as _onImmediate] (/home/freddy/BiteBot/node_modules/bluebird/js/release/async.js:15:14)\n    at process.processImmediate (node:internal/timers:491:21)","timestamp":"2025-03-06T07:35:57.532Z"}
{"level":"error","message":"Error showing group order details: Cannot read properties of undefined (reading 'status')","stack":"TypeError: Cannot read properties of undefined (reading 'status')\n    at RestaurantOrderBot.showGroupOrderDetails (/home/freddy/BiteBot/bot.old.js:290:86)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async RestaurantOrderBot.updateGroupOrderStatus (/home/freddy/BiteBot/bot.old.js:369:7)\n    at async TelegramBot.<anonymous> (/home/freddy/BiteBot/bot.old.js:92:11)","timestamp":"2025-03-06T07:50:36.158Z"}
